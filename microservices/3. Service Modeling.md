# 서비스 모델링하기

## 무엇이 좋은 서비스를 만드는가?
1. `느슨한 결합`(loose coupling)
2. `강한 응집력`(high cohesion)

위 두 개념이 잘못되면 나머지도 의미가 없다. 이미 자주사용 되고 있는 용어이지만(특히 객체지향 시스템이라는 맥락에서) 마이크로서비스에서 이 용어들을 논의 할 가치는 충분하다!

### 느슨한 결합
- 하나의 서비스가 변경될 때 다른 서비스가 변경되어야 하는 일이 없어야 한다.
- 마이크로서비스의 요점은 시스템의 그 어떤 부분도 추가/수정 할 필요 없이 특정 서비스를 변경하고 배포할 수 있는것이다.

### 강한 응집력
- 서로 연관된 행위는 한데 모아두고 그렇지 않은 것은 다른곳에 모아둔다.
- 특정 행위를 변경하려면 한 곳에서 변경하고 가능한 한 신속하게 릴리즈 해야 한다.
- 서로 연관된 행위가 한 곳에 모이고, 다른 경계와는 느슨하게 소통할 수 있는 경계를  찾아야 한다. 

## 경계가 있는 콘텍스트(Bounded Context)
- 에릭 에반스의 "도메인 주도 설계(위키북스, 2011)"
- 명료한 경계에 의해 강제된 구체적인 책임
- 모든 도메인은 다수의 경계가 있는 콘텍스트로 구성된다
- 도메인의 문제를 해결하기 위한 도메인 모델이 존재하는 명시적인 경계

### 감춰진 공유 모델
- 밀접하게 연관된 기능을 개발하는 경우 모델의 일부분을 공유할 수 있다.
    - ex) `재무` 도메인은 회사 평가를 산출하기 위해 `재고 품목` 정보가 필요하며 `재고 품목`은 `창고` 도메인이 제공한다. 재고 품목은 두 콘텍스트 간의 공유 모델이 된다.
- 공유하는 모델의 부분집합을 명시하고, 이 부분은 협의 없이 변경하면 안된다.
- 콘텍스트 내부 적인 모든 것을 공유 모델에 노출할 필요는 없다.
- 내부 전용 표현과 외부 전용 표현으로 구분할 수 있다.
- Provider / Consumer

### 모듈과 서비스
- 콘텍스트 경계 내에서는 관련된 코드를 한데 모으고 시스템 내의 다른 모듈과의 결합도를 낮추기 위해 모듈을 사용할 수 있다.
- 도메인에서 경계가 있는 콘텍스트들을 발견했다면 감춰진 공유 모델을 이용하여 모듈로 모델링하자.

### 성급한 분해
- 시스템을 마이크로서비스로 성급하게 분리하면 막대한 비용이 소요될 수 있다.
- 기존 코드베이스를 마이크로서비스로 분해하는 것이 처음부터 마이크로서비스로 가는 것 보다 훨씬 쉽다.

## 비즈니스 능력
- 경계가 있는 콘텍스트에 대해 고민할 때는 공유 데이터 관점이 아닌 나머지 도메인을 제공하는 콘텍스트의 능력 관점에서 봐야 한다.
- '이 콘텍스트는 무엇을 하는가?'와 '그 일을 하기위해 어떤 데이터가 필요한가?'를 먼저 물어보자.

## 거북이 밑에 거북이
- 마이크로서비스의 경계 고려할 때는 우선 더 넓고 큰 단위의 콘텍스트 관점에서 생각한 뒤, 분리를 통한 혜택을 발견했을 때 내포된 컨텍스트들을 세분화 하자.
- 컨테스트의 분리 방식은 조직 구조를 기반으로 해야한다.

## 비즈니스 컨셉 관점에서의 커뮤니케이션
- 비즈니스 도메인에 기반을 둔 소프트웨어 모델링은 경계가 있는 콘텍스트 개념에 멈춰서는 안된다. 
- 조직 내에서 공유되는 동일한 용어와 개념이 인터페이스에 반영 되어야 한다.

## 기술적 경계
- 기술적 접합부를 따라 수평적으로 나누기 보다는 비즈니스에 초점을 맞추어 수직적으로 나누어야 한다.(수평적으로 나누는게 항상 잘못된 것은 아님)

## 결론
- 좋은 서비스를 만드려면 느슨한 결합과 높은 응집력의 혜택을 얻을 수 있는 접합부를 찾아야 한다.
- 경계가 있는 콘텍스트는 이러한 접합부를 찾는데 중요한 도구이다.
